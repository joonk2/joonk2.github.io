---
title: "PCA"
layout: post
categories: [math, linear-algebra]
tags: [math, LinearAlgebra, EigenValue, pca, diagonalization, Lagrange Multiplier, ì£¼ì„±ë¶„ ë¶„ì„, ë¼ê·¸ë‘ì£¼ìƒìˆ˜ë²• ,ì„ í˜•ëŒ€ìˆ˜í•™, ì •ì‚¬ì˜í–‰ë ¬, ìµœì†Œì œê³±ë²•, ëŒ€ê°í–‰ë ¬, ëŒ€ì¹­í–‰ë ¬, symmetric]
toc: true
toc_sticky: true
date: 2024-05-03
updated: 
---

<!-- MathJax Script for this post only -->
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ['\\(','\\)'] ],
      displayMath: [ ['$$','$$'], ['\\[','\\]'] ],
      processEscapes: true
    }
  });
</script>
#### ğŸ™…â€â™‚ï¸íœ´ëŒ€í°ìœ¼ë¡œ ë³¼ ë•Œ í˜¹ì‹œ ê¸€ìë‚˜ ìˆ«ìê°€ í™”ë©´ì— ë‹¤ ì•ˆë‚˜ì˜¤ë©´<span style="color:red">**,**</span> íœ´ëŒ€í° ê°€ë¡œë¡œ ëŒë¦¬ì‹œë©´ ë©ë‹ˆë‹¤

```markdown
<ëª©ì°¨>
1. PreRequisites
2. PCA 
 2-1. PCAë€?
 2-2. PCAì¦ëª… (ì¢€ ê¸¸ë‹¤)
  (1) ğŸ˜‹minimize(ìµœì†Œí™”)
  (2) ğŸ§â€â™€ï¸maximize
3. PCA ì‘ìš©
 3-1. ì°¨ì›ì¶•ì†Œ(ì˜ˆì‹œ)
 3-2. ì°¨ì›ì¶•ì†Œ(ì˜ìƒ)
```

# 1. PreRequistes
1. [Eigen decompostion](https://joonk2.github.io/posts/linear-algebra-part5/) <br>
2. [Lagrange Multiplier](https://joonk2.github.io/posts/lagrangian-multiplier/) <br>
3. [LSM](https://joonk2.github.io/posts/projectionmatrix-and-lsm/) <br>
4. [covariance matrix](https://joonk2.github.io/posts/covariance-matrix/) <br><br>

# 2. PCA
## 2-1. PCAë€?
![Desktop View](/assets/img/math/LinearAlgebra/pca/1.png) <br>

### **<span style="color:red">ëª©í‘œ:</span>**
ì°¨ì› ì¶•ì†Œë¥¼ í•  ë•Œ ì› ë°ì´í„°ì˜ ë¶„ì‚°ì„ ë³´ì¡´í•  ê²ƒ <br>

### **<span style="color:red">ê°œë…:</span>**
ì¢Œí‘œê°’ë“¤ì´ í•˜ë‚˜ì˜ ë°ì´í„°ë‹¤ ê·¸ë˜ì„œ ì—¬ëŸ¬ ê°œì˜ ë°í„°ê°€ ë¶„í¬ë¥¼ ì´ë£¨ê³  ìˆìŒ <br>
ì—¬ê¸°ì„œ ë°ì´í„° ë¶„í¬ì˜ í‰ê· ìœ¼ë¡œë¶€í„° ì‹œì‘í•´ ë°ì´í„°ì˜ ë¶„í¬ë¥¼ ê°€ì¥ ì˜ ì„¤ëª…í•´ì£¼ëŠ” ë°©í–¥ì„ PCAë¼ í•œë‹¤. <br>
ì¦‰ ëª©í‘œë¥¼ ì¬ì •ì˜í•˜ìë©´ ë‹¤ì‹œë§í•´ $$\color{red}{\nearrow}$$ì˜ ë²¡í„°ë¥¼ ì°¾ì•„ ì°¨ì›ì¶•ì†Œë¥¼ í•´ì•¼í•œë‹¤ <br>

### **<span style="color:red">ì˜ˆì‹œ:</span>**
ë§Œì•½ ë‚´ê°€ ì°¾ì€ ì£¼ì„±ë¶„ ë²¡í„°ì— ë°ì´í„°ë“¤ì„ í™•ëŒ€í•´ì„œ ë´¤ì„ ë•Œ, <br>
1ì°¨ì› ì¶•ìœ¼ë¡œ ë°ì´í„°ë“¤ì„ ì •ì‚¬ì˜ ì‹œì¼°ë‹¤ê³  í•˜ì <br>
![Desktop View](/assets/img/math/LinearAlgebra/pca/2.png) <br>
ì°¨ì› ì¶•ì†Œ (2D $$\Rightarrow$$ 1D) <br>

### **<span style="color:red">ê²°ë¡ :</span>**
![Desktop View](/assets/img/math/LinearAlgebra/pca/3.png) <br>

ìœ„ì˜ ê°œë…ì„ í† ëŒ€ë¡œ ì´ ë¶„í¬ì˜ ë¶„ì‚°ì´ ê°€ì¥ í° ë°©í–¥ì¸ $$\color{red}{\nearrow}$$ê°€ ì´ ë¶„í¬ë¥¼ ê°€ì¥ ì˜ì„¤ëª…í•˜ëŠ” ë°©í–¥ì´ê³ , <br>
ê·¸ë¦¬ê³  ë‘ ë²ˆì§¸ë¡œ ë¶„ì‚°ì´ í¬ê³  ì²«ë²ˆì§¸ ì£¼ì„±ë¶„ê³¼ orthogonal í•œ ë°©í–¥ì¸ $$\color{green}{\nearrow}$$ê°€ 2ë²ˆì§¸ë¡œ ì˜ ì„¤ëª…í•œë‹¤. <br><br><br>

## 2-2. PCAì¦ëª… (ì¢€ ê¸¸ë‹¤)
ë‹¹ì—°í•˜ê²Œ ë°›ì•„ë“¤ì´ì§€ë§ê³  PCA ê°œë…ì— ëŒ€í•´ ì§ˆë¬¸ì„ ë˜ì ¸ë³´ì <br>
**<font color='lightgreen'>---------------ì§ˆë¬¸-----------------</font>** <br>
1ï¸âƒ£ ì™œ ë¶„ì‚°ì´ ê°€ì¥ í° ë°©í–¥ì´ ì´ ë¶„í¬ë¥¼ ì˜ ì„¤ëª…í•˜ëŠ”ê°€? <br>
2ï¸âƒ£ ì™œ ê·¸ë‹¤ìŒìœ¼ë¡œ ì˜ ì„¤ëª…í•˜ëŠ” ë°©í–¥ì€ ì²« ë²ˆì§¸ ì£¼ì„±ë¶„ì— ìˆ˜ì§í•˜ëƒ? <br>
**<font color='lightgreen'>-----------------------------------------</font>** <br><br>

ì ì£¼ì„±ë¶„ë¶„ì„ ì¦ëª…ì„ ì²˜ìŒë¶€í„° ì°¨ê·¼ì°¨ê·¼ ì‹œì‘í•´ë³´ì <br>
ìš°ì„  í‰ê· ìœ¼ë¡œë¶€í„° ì¶œë°œí•´ ê°€ì¥ ë¶„í¬ë¥¼ ì˜ ì„¤ëª…í•˜ëŠ” ë°©í–¥ì„ ì°¾ì•„ì•¼í•˜ë‹ˆ <br>
í˜„ì¬ 4ì‚¬ë¶„ë©´ì— ìˆëŠ” ë¶„í¬ë“¤ì˜ í‰ê· ì´ 0ì´ ë˜ë„ë¡ ë¶„í¬ì˜ ì¤‘ê°„ì ì„ ê¸°ì¤€ì—ì„œ ì›ì ìœ¼ë¡œ ì˜®ê¸°ì <br>
ì´ê²Œ ë¬´ìŠ¨ ë§ì´ëƒë©´ ì•„ë˜ ê·¸ë¦¼ ì°¸ê³  <br>

![Desktop View](/assets/img/math/LinearAlgebra/pca/4.png)
<br><br>

ë‹¤ì‹œ ë³¸ë¡ ìœ¼ë¡œ ë„˜ì–´ê°€ì„œ ì•„ë˜ ê·¸ë¦¼ì„ ë³´ì <br>

![Desktop View](/assets/img/math/LinearAlgebra/pca/5.png) <br>

ì ì´ì œ x,y ë¶„í¬ë“¤ì— ìˆëŠ” nê°œ ì¤‘ì—ì„œ ië²ˆì§¸ ë°ì´í„°ë¥¼ $d_i$ ë¼ í•˜ì  &nbsp;&nbsp;&nbsp; $$d_i = \begin{bmatrix} x_i \\ y_i\end{bmatrix}$$ <br>
**<font color='blue'>í‰ê· ì„ ë¹¼ì§€ ì•Šì€ ê²ƒ</font>**ì€ ì´ë ‡ê²Œ ë‚˜íƒ€ë‚´ì &nbsp;&nbsp;&nbsp;  $$\tilde{d_i} \color{blue}{=} \begin{bmatrix} x_i \\ y_i\end{bmatrix}$$ <br>
**<font color='red'>í‰ê· ì„ ëº€ ê²ƒ</font>**ì„ ì´ë ‡ê²Œ â€”> &nbsp; $$\bar{d_i} \color{red}{=} \begin{bmatrix} \bar{x_i} \\ \bar{y_i}\end{bmatrix}$$ <br>
ê·¸ë¦¬ê³  ìœ„ì˜ 2ë²ˆì§¸ ê·¸ë˜í”„ë¥¼ ë³´ë©´ x, yê°’ì˜ ë¶„í¬ë¥¼ ë‚˜íƒ€ë‚¸ ê²ƒì´  $$\ddots\ddots\ddots\ddots\cdots \color{pink}{\bullet}$$ ì´ë ‡ê²Œ ì—¬ëŸ¬ ê°œì˜ ì ë“¤ë¡œ ìˆëŠ”ë° <br>
ê·¸ í‰ê· ì„ ì‹¹ êµ¬í•´ ëŒ€ì…í•œ ê²ƒì´ $$\bar{d_i} = \begin{bmatrix} \bar{x_i} \\ \bar{y_i}\end{bmatrix}$$ ì´ê²ƒì´ê¸°ë„ í•˜ë‹¤ <br><br>

### **<font color='purple'>(1) ğŸ˜‹minimize(ìµœì†Œí™”)</font>**
ì ê¹ ì˜ìƒì„ ì°¸ê³ í•˜ì <br>
![Desktop View](https://github.com/joonk2/math/raw/main/linear-algebra/pca/pca.gif)

**<font color='red'>(</font>**ì´ ì˜ìƒì€ ëª¨ë“  ë¶„í¬ë“¤ì˜ ìµœì†Œ errorë¥¼ ì°¾ëŠ” ê²ƒ, ì¦‰ ì£¼ì„±ë¶„ì„ ì°¾ëŠ” ê³¼ì •ì´ë‹¤**<font color='red'>)</font>** <br>

ì ì›ë˜ëŠ” x,y ë¶„í¬ë“¤ì´ ìˆì„ ë•Œ ëª¨ë“  ì ë“¤ê³¼ ë¹„êµí•˜ì—¬ error(ê°’)ì´ ê°€ì¥ ì‘ì„ ë•Œê°€ ì–¸ì œì¸ì§€ ë¹„êµí•˜ëŠ”ê²Œ ë§ëŠ”ë° ê·¸ëŸ¬ë©´ ë„ˆë¬´ í• ê²Œ ë§ì•„ì§€ë¯€ë¡œ <u>ë‚˜ëŠ” ì  í•˜ë‚˜ë§Œ ë³´ê² ë‹¤</u> <br>
ê·¸ëŸ¬ë©´ ì´ì œë¶€í„° orthogonalí•˜ë©´ì„œ errorê°€ ê°€ì¥ ì ì€ ì ê³¼ ì—°ê²°í•´ì•¼í•˜ëŠ”ë° ì„ì˜ì˜ x,yë¥¼ ê°€ì§„ $$\color{pink}{\bullet}$$ì ì„ í–¥í•˜ëŠ” ë²¡í„°ê°€ ìˆì„ ê²ƒì´ê³  $$\vec{u}$$ë¡œ $$\perp$$í•˜ê²Œ ìˆ˜ì„ ì˜ ë°œì„ ë‚´ë¦¬ì! ê·¸ë ‡ê²Œ ë˜ë©´ ê·¸ ê¸¸ì´ëŠ” `ì˜¤ì°¨`ë‹¤ <br>
ì ì—¬ê¸°ì„œ ê°x,y ì ë“¤ì˜ ë¶„í¬ì˜ ë¶„ì‚°ì„ ê°€ì¥ ì˜ ì„¤ëª…í•˜ëŠ” ë°©í–¥ì€ projection ë‚´ë ¸ì„ ë•Œ $$error^2$$ì„ ê°€ì¥ ì‘ê²Œ ë§Œë“œëŠ” ë°©í–¥ìœ¼ë¡œ í–¥í•˜ë”ë¼ <br>

ì•„ë˜ ì˜ìƒì„ ë³´ë©´ ìµœì†Œ êµ¬ê°„ì„ ì°¾ë‹¤ê°€ ì°¾ìœ¼ë©´ ë©ˆì¶°ì„œ ë§ ê·¸ëŒ€ë¡œ ìˆ˜ì„ ì˜ ë°œì„ ë‚´ë ¤ $$\perp$$ëœë‹¤ <br>

![Desktop View](https://github.com/joonk2/math/raw/main/linear-algebra/pca/pca-custom.gif)
![Desktop View](/assets/img/math/LinearAlgebra/pca/6.png) <br>

ì•„ ì´ê²ƒìœ¼ë¡œ `1ï¸âƒ£ ì™œ ë¶„ì‚°ì´ ê°€ì¥ í° ë°©í–¥ì´ ì´ ë¶„í¬ë¥¼ ì˜ ì„¤ëª…í•˜ëŠ”ê°€?` ì— ëŒ€í•œ ì§ˆë¬¸ì€ í•´ê²°ì´ ë˜ì—ˆêµ° <br>
ì´ì–´ì„œ minì„ êµ¬í•˜ëŠ”ë° í•„ìš”í•œ ìˆ˜ì„ ì˜ë°œ ì¦‰ errorì˜ ê¸¸ì´ë¥¼ êµ¬í•˜ê¸° ìœ„í•´ ì•„ë˜ í‘œë¥¼ ë³´ì <br>

**<font color='lightgreen'>----------------ì°¸ê³ -------------------</font>** <br>
**<font color='pink'>(1)</font>** $$d_i^T u$$  &nbsp; ì •ì‚¬ì˜í•œ ê²°ê³¼ $$\Rightarrow$$ ì¦‰ ìŠ¤ì¹¼ë¼ <br>
**<font color='pink'>(2)</font>** $$d_i^T u\cdot u$$ &nbsp; ì •ì‚¬ì˜í•œ ê²°ê³¼ì— uì™€ ë‚´ì í•˜ì—¬ uë°©í–¥ì„±ë¶„ì„ íšë“ <br>
**<font color='pink'>(3)</font>** $$\left(d_i-d_i^T u\cdot u\right)$$ &nbsp; $$d_i$$ ë²¡í„°ì—ì„œ uë²¡í„°ì˜ ì„±ë¶„ ì œê±°<br>
(ì¦‰ $$a^Ta$$ ê¼´ë¡œ ë§Œë“¤ë©´ ì œê³±ì²˜ëŸ¼ ë˜ì–´ ë†’ì´ì¸ ì˜¤ì°¨ë¥¼ êµ¬í•  ìˆ˜ ìˆë‹¤) <br>
**<font color='lightgreen'>-------------------------------------------</font>** <br><br>

![Desktop View](/assets/img/math/LinearAlgebra/pca/7.png) <br>

ì ì € ë°ì´í„° í•˜ë‚˜ì˜ error lengthì— ëŒ€í•œ ì‹ì€ ì´ë ‡ë‹¤ $$\color{red}{\Rightarrow}$$  $$\left(d_i-d_i^T uu\right)^T \left(d_i-d_i^T uu\right)$$ <br>
ì–´ ì´ê±´ $$L_2$$ normì˜ $$\sqrt{x_1^{2}+x_2^{2}+\cdots}$$ í˜•ì‹ì´ë„¤? <br>

ê·¼ë° ì•„ê¹Œë„ ë§í–ˆì§€ë§Œ $$d_i$$ë“¤ ì¤‘ í•œ ì ì´ ì•„ë‹ˆë¼ Nê°œì˜ ëª¨ë“  ë°ì´í„°ì—ì„œ ê³ ë ¤í•´ì•¼í•˜ë‹ˆ <br>
$$\frac{1}{N}\sum_{i} \left(d_i-d_i^T uu\right)^T \left(d_i-d_i^T uu\right)\\ S.T. \quad \vert\vert u\vert\vert_2^2 = u^Tu=1$$ <br>
**<font color='red'>í•´ì„</font>** $$\Rightarrow$$ ì „ì²´ $$d_i$$ error lengthë¥¼ ë”í•œ ê²ƒì„ ì œê³±í•´ Nê°œë¡œ ë‚˜ëˆ ì£¼ëŠ”ë°**<font color='red'>,</font>** &nbsp; ì¡°ê±´ì€ ì˜¤ì°¨ê±°ë¦¬ì œê³±ì´ 1ì¼ê²ƒ <br><br>

ì—¬ê¸°ì„œ ë¶„ë°°ë²•ì¹™í•´ë³´ì &nbsp;&nbsp; ì°¸ê³ ë¡œ $$d_i^T u$$ëŠ” ìŠ¤ì¹¼ë¼ë¼ì„œ transposed ì˜í–¥ ì•ˆ ë°›ëŠ”ë‹¤<br>
$$\frac{1}{N}\sum_{i} \left(d_i^Td_i-d_i^Tu\cdot u^Td_i-d_i^T(d_i^Tu)u+d_i^Tu\cdot u^T(d_i^Tu)u\right)$$ <br>
ì ì•„ê¹Œ ì„ì˜ë¡œ $u^Tu=1$ë¡œ ì¡°ê±´ì„ ë¶€ì—¬í•˜ì˜€ê³  ìŠ¤ì¹¼ë¼ëŠ” ì•ìœ¼ë¡œ ë³´ë‚¼ ìˆ˜ ìˆìœ¼ë‹ˆê¹Œ <br>
$$\frac{1}{N}\sum_{i} \left(d_i^Td_i-d_i^Tu\cdot u^Td_i-(d_i^Tu)d_i^Tu+(d_i^Tu)d_i^Tu\cdot u^Tu\right)\\ \Rightarrow \frac{1}{N}\sum_{i} \left(d_i^Td_i-d_i^Tu\cdot u^Td_i\right)$$ <br>
ìœ„ì²˜ëŸ¼ ì „ê°œê°€ ë˜ëŠ”ë° ìš°ë¦¬ëŠ” $$\vec{u}$$ê°€ í•„ìš”í•˜ê³ , $$d_i^Td_i$$ ì´ê±° í•„ìš” ì—†ìœ¼ë‹ˆê¹Œ ì œê±°í•˜ì <br><br>

ê·¸ë ‡ê²Œ ë˜ë©´ ë‚¨ëŠ” ì‹ì€ ì•„ë˜ì™€ ê°™ë‹¤ <br>
$$\Rightarrow \frac{1}{N}\sum \left(-d_i^Tu\cdot u^Td_i\right)$$ <br>
ì ê·¸ë¦¬ê³  ì•„ê¹Œ errorì¸ ì´ì‹ì„ ì°¸ê³  í•˜ì &nbsp; $$d_i=\tilde{d_i}-\bar{d_i}$$ <br>
ê·¸ë¦¬ê³  uëŠ” $$d_i$$ì™€ ê´€ê³„ì—†ìœ¼ë‹ˆ ì•ì— ë¹¼ì£¼ì ê·¸ëŸ¼ ì‹ì„ ìœ„ì¹˜ë¥¼ ë°”ê¾¸ì–´ ì „ê°œ ê°€ëŠ¥í•˜ê² ë„¤â¬‡ï¸ <br> 
$$\Rightarrow \frac{1}{N}\sum_{i} \left(-u^Td_i\cdot d_i^Tu\right) \\ \Rightarrow -u^T\frac{1}{N}\sum \left(d_i\cdot d_i^T\right)u \\ \Rightarrow -u^T\frac{1}{N}\sum_i \left((\tilde{d_i}-\bar{d_i})(\tilde{d_i}-\bar{d_i})^T\right)u$$ <br>
![Desktop View](/assets/img/math/LinearAlgebra/pca/8.png) <br>

ì $$\color{lightgreen}{\square}$$ëŠ” sample covariance matrixë‘ ë¹„ìŠ·í•˜ë„¤? <br>
$$\begin{bmatrix} cov(x,x) & cos(x,y) \\cov(y,x) & cos(y,y) \end{bmatrix}$$ &nbsp; ì´ê²Œ covariance matrixì¸ë° symmetricí•˜ì—¬ diagonalizableí•˜ê¸° ë•Œë¬¸ì´ë‹¤.<br>
<u>ê·¼ë° diagonalizableí•˜ë‹¤ê³  symmetricí•˜ì§€ëŠ” ì•Šë‹¤ ì•Œì•„ë‘ì</u> <br>
ì•„ë¬´íŠ¼ $$\color{lightgreen}{\square} = R_d$$ë¼ í•˜ê² ë‹¤ <br>
ì ê·¸ëŸ¬ë©´ $$-u^TR_du$$ë¼ê³  í‘œí˜„í•  ìˆ˜ ìˆê² ë„¤ <br>
ì´ë•Œ $$R_d$$ë¥¼ í†µí•´ ìƒê°í•  ìˆ˜ ìˆëŠ” ê²ƒë“¤ &nbsp;&nbsp; $$\begin{cases}if \quad 1D \rightarrow ë¶„ì‚°\\ if \quad 2D \rightarrow covariance \quad matrix\end{cases}$$<br>

ì ìš”ì•½í•˜ìë©´ $$min=-u^T\frac{1}{N}\sum_i \left((\tilde{d_i}-\bar{d_i})(\tilde{d_i}-\bar{d_i})^T\right)u$$ ì´ê³  <br>
ë³€ìˆ˜ë¥¼ í†µí•´ ë°”ê¾¸ë©´ $$min\color{red}{=}-u^TR_du$$ ì´ë ‡ê²Œ í‘œí˜„í•  ìˆ˜ ìˆê² ë„¤ <br><br><br>

### **<font color='purple'>(2) ğŸ§â€â™€ï¸maximize(ìµœëŒ€í™”)</font>**
ì ê°„ë‹¨í•˜ê²Œ ì–˜ê¸°í•´ ìœ„ì˜ ì‹ì—ì„œ -ë¶€í˜¸ë§Œ ëº€ ê²ƒì´ë‹¤ &nbsp; $$max\color{red}{=}u^TR_du$$ <br>
ì´ê²ƒì— ëŒ€í•œ ì¦ëª…ì€ **<font color='violet'>Lagrangian function</font>** ì“°ì <br>
$$L=u^TR_du+\gamma(1-u^Tu)$$ <br>

$$\vec{u}$$ ì— ëŒ€í•œ ë¯¸ë¶„ $$\Rightarrow$$ ì¦‰ $$\vec{u}$$ì— ëŒ€í•œ ë³€í™”ëŸ‰ì„ ì•Œì•„ë³¸ë‹¤ëŠ” ëœ»ì´ë‹¤. <br>
$$dLu=du^TR_du\color{red}{+} u^TR_ddu\color{red}{-}\gamma d\color{skyblue}{u^Tu}\color{red}{-} \gamma\color{skyblue}{u^T}d\color{skyblue}{u}$$ <br>
ì—¬ê¸°ì„œ $$\color{skyblue}{u^Tu}$$ëŠ” ìŠ¤ì¹¼ë¼ë‹ˆê¹Œ transposed ì·¨í•´ë„ ë˜‘ê°™ë‹¤ <br>

$$\Rightarrow 2u^TR_du \color{red}{-} 2\gamma u^Tdu \\ = \color{violet}{(}2u^TR_d-2\gamma u^T\color{violet}{)}du$$ <br>
ì´ì‹ì—ì„œ $\color{violet}{(}~~~~\color{violet}{)}$ ë¶€ë¶„ì€ $\frac{dL}{du^T}$ë‹¤ ì´ê²Œ ë¬´ìŠ¨ë§ì´ëƒë©´ L/ u row vectorsë¡œ ë¯¸ë¶„í–ˆë‹¤ëŠ” ëœ» <br>

**<font color='lightgreen'>---------------ë²¡í„°ì˜ ë¯¸ë¶„-----------------</font>** <br>
1ê°œì”© ë¯¸ë¶„í•œ ê²ƒì„ ê°€ë¡œë¡œ ìŒ“ì€ ê²ƒ <br>
$$\frac{dL}{du^T}$ $\color{red}{=}$ $\left[\frac{dL}{du_1} \color{lightgreen}{,} \frac{dL}{du_2} \color{lightgreen}{,} \frac{dL}{du_3} \cdots\right]$$ <br>
**<font color='lightgreen'>---------------------------------------------</font>** <br>

ì•„ë¬´íŠ¼ ìš°ë¦¬ëŠ” $$\color{violet}{(}~~~~ \color{violet}{)}$$du ë¼ëŠ” ì‹ì—ì„œ $$\color{violet}{(}~~~~ \color{violet}{)}$$ê°€ ë¯¸ë¶„ì´ë€ ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤ <br>

### ğŸ§‘â€ğŸ¨**<font color='skyblue'>ê³„ì‚°</font>**
ì ê·¸ëŸ¼ ìš°ë¦¬ê°€ í•  ê²ƒì€ $\frac{dL}{du^T}=0$ ì„ ë§Œì¡±í•˜ëŠ” u ì¤‘ì—ì„œ ê°€ì¥ maxë¥¼ ì°¾ì•„ì•¼ í•˜ê³  ì•„ê¹Œ $L$ì‹ì„ ë§Œì¡±í•œë‹¤ <br>
ì•„ë¬´íŠ¼ ì•„ê¹Œ $$\color{violet}{(}~~~~\color{violet}{)}$$ì‹ì—ì„œ ì–‘ë³€ìœ¼ë¡œ ë„˜ê¸°ë©´ $$u^Tr_d=\gamma u^T$$ê°€ ë˜ë„¤ <br>
ê·¸ë¦¬ê³  transposed ì·¨í•´ì£¼ì <u>whyâ€”></u> $$R_d$$ê°€ symmetricí•˜ë‹ˆ ë‹¹ì—°íˆ diagonalizableí•˜ì—¬ orthogonal matrixë¡œ decompose ê°€ëŠ¥<br>
(ì°¸ê³ ë¡œ $$\gamma$$ëŠ” ìŠ¤ì¹¼ë¼ë¼ transposed ì˜í–¥ ì—†ë‹¤) <br>

$$\left(u^Tr_d\right)^T=\left(\gamma u^T\right)^T \\ \color{red}{\Rightarrow} R_du = \gamma u \quad\quad\quad (\gamma: EigenValue,\quad u: EigenVector)$$ <br>

ì ì´ì œ $$R_d$$ë¥¼ decompose í•˜ì <br>
ê·¸ëŸ¬ê¸° ìœ„í•´ ì•„ê¹Œ ì „ì— ë´¤ë˜ ì‹ì¸ $$max=u^TR_du$$ë¡œ ë„˜ì–´ê°€ì <br>
$$R_d$$: &nbsp;&nbsp;&nbsp; symmetricí•´ì„œ diagonalizableë˜ë¯€ë¡œ orthogonal matrixë¡œ decomposeëœë‹¤ê³  í–ˆë‹¤ <br>
$$u^TR_du \color{red}{=} u^T\left(\gamma_1 q_1q_1^T \color{red}{+} \gamma_2 q_2q_2^T \color{red}{+} \cdots \right)u$$  <br>
uê°€ ë¬´ì—‡ì¼ ë•Œ $$q_1, ~~ q_2, ~~ \cdots$$ê°€ í° ê°’ìœ¼ë¡œ ë‚˜ì˜¬ê¹Œ ? <br>

ì ì•„ê¹Œ uëŠ” $$R_d$$ì˜ EigenVectorë¼ê³  í–ˆë‹¤ ê·¸ë§ì€ uê°€ $$q_1, q_2, \cdots$$ ì¤‘ì— í•˜ë‚˜ë¼ëŠ” ì–˜ê¸°ë‹¤ <br>
ì¢‹ë‹¤ ê·¸ëŸ¼ ë§Œì•½ $$\gamma_1 \quad \gamma_2\cdots$$ì´ ë‚´ë¦¼ì°¨ìˆœì´ê³ ,&nbsp;&nbsp; $$u=q_1$$ ë¡œ ë³´ì <br>
$$\Rightarrow q_1^T \left(\gamma_1 q_1q_1^T\right)q_1$$ &nbsp; ì´ë ‡ê²Œ ë˜ëŠ”ë° $$q_1^Tq_1=1$$ë¡œ ìƒì‡„ë˜ë‹ˆ $$\gamma_1$$ë§Œ ë‚¨ëŠ”ë‹¤ <br>
ì ê·¸ëŸ¼ ë‚´ë¦¼ì°¨ìˆœì´ë¼ í–ˆìœ¼ë‹ˆ $$\gamma_1$$ì´ ê°€ì¥ í° ì£¼ì„±ë¶„ ë²¡í„°ê³  ê·¸ë‹¤ìŒìœ¼ë¡œëŠ” $$\gamma_2$$ë‹¤ <br>
ì°¸ $$q_1 \perp q_2$$ë‹ˆê¹Œ ì¦‰ orthogonalí•˜ì—¬ ì•„ë˜ ê·¸ë¦¼ì˜ ë¶„ì‚°ì •ë„ë¥¼ ë³´ë©´ $$q_2$$ê°€ ì™œ 2ë²ˆì§¸ë¡œ í° ì£¼ì„±ë¶„ìœ¼ë¡œ ë¶„í¬ë¥¼ ì˜ ì„¤ëª…í•˜ëŠ”ì§€ ì•Œ ìˆ˜ ìˆë‹¤ <br>

![Desktop View](/assets/img/math/LinearAlgebra/pca/9.png) <br>

ì ì´ì œ `2ï¸âƒ£ ì™œ ê·¸ë‹¤ìŒìœ¼ë¡œ ì˜ ì„¤ëª…í•˜ëŠ” ë°©í–¥ì€ ì²« ë²ˆì§¸ ì£¼ì„±ë¶„ì— ìˆ˜ì§í•˜ëƒ?` ì§ˆë¬¸ì— ëŒ€í•œ ë‹µì„ í•  ìˆ˜ ìˆë‹¤ <br><br><br>

# 3. PCA ì‘ìš©
## 3-1. ì°¨ì›ì¶•ì†Œ(ì˜ˆì‹œ)
100ì°¨ì› ë°ì´í„°ê°€ ìˆë‹¤ê³  ê°€ì •í•˜ì <br>

$$\begin{bmatrix} x\\y\\z\\ \vdots\\\vdots\\\vdots \end{bmatrix}$$ &nbsp; ì´ê²ƒì„ 100ì°¨ì›ì˜ í•œ ì ì´ë¼ í•˜ì <br>

![Desktop View](/assets/img/math/LinearAlgebra/pca/10.png) <br>

ì—¬ê¸°ì„œ 100 Dim dataì— ìˆëŠ” í•œ ì  â€”> 2 Dim dataë¡œ ì¶•ì†Œí•˜ë ¤ë©´ <br>
ië²ˆì§¸ ë°ì´í„°ê°€ ìˆì„ ë•Œ ì¶•ì†Œí•œ ê²°ê³¼ê°€ ì´ë ‡ê²Œ ëœë‹¤ $$d_i^Tq_1\cdot q_1+d_i^Tq_2\cdot q_2$$<br> 
ì ì•ì—ì„œë„ ì–˜ê¸°í–ˆì§€ë§Œ ìœ„ëŠ” `ê°ê° ë‚´ì xë°©í–¥ì„±`ì„ ë‚˜íƒ€ë‚¸ ê±°ì´ë‹¤ <br>
ì•„ë¬´íŠ¼ ì´ ì‹ì´ ë¬´ìŠ¨ ë§ì´ëƒë©´ ì–´ë–¤ ê³µê°„ì´ ìˆì„ ë•Œ 2 Dimì— ë‚´ë¦°ë‹¤ëŠ” ê²ƒì¸ë° <br>
ì´ 2ì°¨ì›ì€ $$q_1 \quad q_2$$ê°€ span í•˜ëŠ” ê³³ì´ë‹¤ <br>

![Desktop View](/assets/img/math/LinearAlgebra/pca/11.png) <br>

ì´ê²Œ ë¬´ìŠ¨ ë§ì´ëƒë©´ $$q_1=\begin{bmatrix}  \vdots\\\vdots\\\vdots \end{bmatrix}, \quad q_2=\begin{bmatrix}  \vdots\\\vdots\\\vdots \end{bmatrix}$$ &nbsp; ê°ê° 100ê°œì˜ ë°ì´í„°ê°€ ìˆëŠ”ë° <br>
$$q_1$$ê³¼ $$q_2$$ë¡œ linear combination ì¦‰ spaní•˜ê²Œ ë˜ë©´ <br>
$$a\begin{bmatrix}  \vdots\\\vdots\\\vdots \end{bmatrix}+ b\begin{bmatrix}  \vdots\\\vdots\\\vdots \end{bmatrix}$$ &nbsp; ì¦‰ 2 Dim í‰ë©´ë§Œ ë‚˜íƒ€ë‚¸ë‹¤ëŠ” ëœ» <br>

ì ê·¸ëŸ¼ $$\color{blue}{\bullet}$$ì„ 100 Dim ìœ„ì˜ í•œ ì ì´ë¼ í•˜ê³  ê·¸ê²ƒì„ ì•„ë˜ë¡œ ë‚´ë ¸ë‹¤ê³  ì¹˜ì <br>

![Desktop View](/assets/img/math/LinearAlgebra/pca/12.png) <br>

ì—¬ê¸°ì„œ 2 Dimìœ¼ë¡œ ë‚´ë¦° ì ì´ $$d_i^Tq_1\cdot q_1+d_i^Tq_2\cdot q_2$$ ë‹¤ <br> 

ì ì—¬ê¸°ì„œ ì •ì‚¬ì˜í•œ ì ì˜ ê°’ì„ ì°¾ê¸° ìœ„í•´ ì¢Œí‘œê°’ì„ êµ¬í•´ì•¼ë˜ëŠ”ë° <br>
$$q_1$$ ì¶•ìœ¼ë¡œì˜ ì¢Œí‘œê°’ì„ ë‚´ì í•œ ê°’ $$\Rightarrow$$ $$d_i^Tq_1$$ <br>
ë§ˆì°¬ê°€ì§€ë¡œ $q_2$ ì¶•ìœ¼ë¡œì˜ ì¢Œí‘œê°’ì„ ë‚´ì í•œ ê°’ $$\Rightarrow$$ $$d_i^Tq_2$$ <br>
ê·¸ëŸ¼ ì •ì‚¬ì˜í•œ ì ì„ í‘œí˜„í•˜ë ¤ë©´ $$a\begin{bmatrix}  1\\0 \end{bmatrix}+ b\begin{bmatrix}  0\\1 \end{bmatrix}$$ &nbsp; ì´ëŸ°ì‹ìœ¼ë¡œ ì§„í–‰ë˜ê² ì§€? <br>

![Desktop View](/assets/img/math/LinearAlgebra/pca/13.png) <br>

ì •ì‚¬ì˜í•œ ì ì˜ ì‹ì€ ì•„ë˜ ì‹ì˜ ì—­í• ì„ ëŒ€ì²´í•´ì¤€ë‹¤ <br>

![Desktop View](/assets/img/math/LinearAlgebra/pca/14.png) <br>

ìŒ ê·¸ëŸ¬ë©´ ë°ì´í„° 10000ê°œ ì¤‘ì—ì„œ $$q_{1(100*1)}$$, &nbsp; $$q_{2(100*1)}$$ì´ë‹ˆ <br>
2ì°¨ì› ì¶•ì†Œë¥¼ ìœ„í•´ì„œëŠ” ìˆ«ì 200ê°œê°€ í•„ìš”í•˜ê² êµ° <br><br>

## 3-2. ì°¨ì›ì¶•ì†Œ(ì˜ìƒ)
16x16ì¸ 256 Dimì—ì„œ PCAë¥¼ í†µí•´ 3 Dimìœ¼ë¡œ ì••ì¶•í–ˆì„ ë•Œ <br>

![Desktop View](https://github.com/joonk2/math/raw/main/linear-algebra/pca/dim-reduction.gif)
<br><br>

# ì°¸ê³ 
1. [í˜íœí•˜ì„ &nbsp;&nbsp; **ì£¼ì„±ë¶„ ë¶„ì„ (PCA: Principal Component Analysis) ì˜ ëª¨ë“  ê²ƒ!, ê³ ìœ³ê°’ ë¶„í•´ì˜ ì‘ìš©**](https://www.youtube.com/watch?v=C21GoH0Y9AE&t=1667s)
2. [ê³µëŒì´ì˜ ìˆ˜í•™ì •ë¦¬ ë…¸íŠ¸ &nbsp;&nbsp;&nbsp; **ì£¼ì„±ë¶„ ë¶„ì„(PCA)ì˜ ê¸°í•˜í•™ì  ì˜ë¯¸**](https://www.youtube.com/watch?v=YEdscCNsinU)
3. [ë¸Œë¦­ &nbsp;&nbsp;&nbsp; **ì£¼ì„±ë¶„ ë¶„ì„ (PCA)ì˜ ì›ë¦¬ì™€ ì „ì‚¬ì²´ ë°ì´í„° ë¶„ì„ì—ì„œì˜ í™œìš©**](https://www.youtube.com/watch?v=c1-DYtWU5t4)
4. **[ê³ ë ¤ëŒ€í•™êµ ì‚°ì—…ê²½ì˜ê³µí•™ë¶€ DSBA &nbsp;&nbsp;&nbsp; 01-4: Dimensionality Reduction - PCA](https://www.youtube.com/watch?v=bEX6WPMiLvo&t=728s)**