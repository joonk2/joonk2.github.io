---
title:  "SQL_6 (Aggregate Functions) [ì§‘ê³„ í•¨ìˆ˜]"
layout: post
categories: [language, sql]
tags: [sql, ì œë¡œë² ì´ìŠ¤]
toc: true
toc_sticky: true
date: 2024-04-02
---

<!-- MathJax Script for this post only -->
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ['\\(','\\)'] ],
      displayMath: [ ['$$','$$'], ['\\[','\\]'] ],
      processEscapes: true
    }
  });
</script>

#### ğŸ™…â€â™‚ï¸íœ´ëŒ€í°ìœ¼ë¡œ ë³¼ ë•Œ í˜¹ì‹œ ê¸€ìë‚˜ ìˆ«ìê°€ í™”ë©´ì— ë‹¤ ì•ˆë‚˜ì˜¤ë©´<span style="color:red">**,**</span> íœ´ëŒ€í° ê°€ë¡œë¡œ ëŒë¦¬ì‹œë©´ ë©ë‹ˆë‹¤

```md
<ëª©ì°¨>

1. count, sum ì‹¤ìŠµ
2. avg, min, max ì‹¤ìŠµ
3. group by, having ì‹¤ìŠµ
```
<br><br><br>

# 1. count, sum ì‹¤ìŠµ
```sql
cd C:\Users\withj\Documents\sql_ws
aws ë¡œê·¸ì¸

use zerobase;
show tables;
select * from police_station;

# 5ê°œë§Œ ë³´ê¸°
select * from crime_status limit 5;

# ë°ì´í„° ê°¯ìˆ˜ --> 121
select count(*) from police_station;

# ê³ ìœ ê°’(ì¤‘ë³µx) --> 31ê°œ
select count(distinct police_station) from crime_status;

# 31ê°œë¥¼ ë‹¨ì–´ë¡œ í™•ì¸
select distinct police_station from crime_status;

# crime_status í…Œì´ë¸”ì˜ crime_typeì»¬ëŸ¼ unique() í™•ì¸
select distinct crime_type from crime_status;

# crime_status í…Œì´ë¸”, case number ì»¬ëŸ¼
# ì¡°ê±´--> status_type="ë°œìƒ" í•©ê³„ 
select sum(case_number) from crime_status where status_type='ë°œìƒ';
```
<br><br><br>

# 2. avg, min, max ì‹¤ìŠµ
## 2-1) ì‚´ì¸ì˜ í‰ê· ê±´ìˆ˜ë¥¼ ê²€ìƒ‰í•˜ê³  í™•ì¸í•˜ì„¸ìš”
```sql
# í‰ê·  ì‚´ì¸ ë°œìƒë¥ 
select avg(case_number) from crime_status
where crime_type like 'ì‚´ì¸' and status_type like 'ë°œìƒ';

# ëˆˆìœ¼ë¡œ í™•ì¸
select * from crime_status 
where crime_type like 'ì‚´ì¸' and status_type like 'ë°œìƒ';
```

## 2-2) ê´‘ì§„ê²½ì°°ì„œì—ì„œ ê°€ì¥ ë‚®ì€ ë²”ì£„ ê²€ê±° ê±´ìˆ˜ë¥¼ ê²€ìƒ‰í•˜ê³  í™•ì¸í•˜ì„¸ìš”
```sql
select min(case_number) from crime_status
where police_station like 'ê´‘ì§„' and status_type like 'ê²€ê±°';
```

## 2-3) ì˜ë“±í¬ê²½ì°°ì„œì˜ ê°€ì¥ ë†’ì€ ë²”ì£„ ë°œìƒ ê±´ìˆ˜ë¥¼ ê²€ìƒ‰í•˜ê³  í™•ì¸í•˜ì„¸ìš”

```sql
select max(case_number) from crime_status
where police_station like 'ì˜ë“±í¬' and status_type like 'ë°œìƒ';
```
<br><br><br><br>

# 3. group by, having ì‹¤ìŠµ
## 3-1) ê²½ì°°ì„œ ë³„ë¡œ ì ˆë„ ë²”ì£„ í‰ê·  ë°œìƒ ê±´ìˆ˜ë¥¼ ê°€ì¥ ë§ì€ ê±´ìˆ˜ ìˆœìœ¼ë¡œ 10ê°œ ê²€ìƒ‰í•˜ê³  í™•ì¸í•˜ì„¸ìš”
```sql
# 2ê°œ í™•ì¸
select * from crime_status limit 2;

# ë³¸ ë¬¸ì œ
select police_station, avg(case_number) from crime_status
where status_type like 'ë°œìƒ' and crime_type like 'ì ˆë„'
group by police_station
order by avg(case_number) desc
limit 10;

# 1ê°œ ê²€ì‚°
select avg(case_number) from crime_status
where police_station like 'ì†¡íŒŒ' and status_type like 'ë°œìƒ' and crime_type like 'ì ˆë„';
```

## 3-2) ê²½ì°°ì„œ ë³„ë¡œ ê°€ì¥ ì ê²Œ ê²€ê±°í•œ ê±´ìˆ˜ ì¤‘ 4ê±´ë³´ë‹¤ í° ê²½ìš°ë¥¼ ê±´ìˆ˜ê°€ í° ìˆœìœ¼ë¡œ ì •ë ¬í•˜ì—¬ ê²€ìƒ‰í•˜ì„¸ìš”
```sql
# ì»¬ëŸ¼ë“¤ í™•ì¸
select * from crime_status limit 2;

# ë³¸ ë¬¸ì œ
select police_station, min(case_number) from crime_status
where status_type like 'ê²€ê±°'
group by police_station
having min(case_number) > 4
order by min(case_number) desc;
```